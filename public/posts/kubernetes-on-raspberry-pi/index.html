<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Kubernetes on Raspberry Pi - Part 1 | Chun Wu</title>
<meta name=keywords content="kubernetes,homelab,raspberrypi,k3s"><meta name=description content="Multi-part series on working with Kubernetes"><meta name=author content="Me"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/kubernetes-on-raspberry-pi/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Kubernetes on Raspberry Pi - Part 1"><meta property="og:description" content="Multi-part series on working with Kubernetes"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/kubernetes-on-raspberry-pi/"><meta property="og:image" content="http://localhost:1313/images/k8s-raspberry-pi/raspberry-pi-cluster.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-01T09:13:03+00:00"><meta property="article:modified_time" content="2024-06-01T09:13:03+00:00"><meta property="og:site_name" content="Chun Wu"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/images/k8s-raspberry-pi/raspberry-pi-cluster.jpg"><meta name=twitter:title content="Kubernetes on Raspberry Pi - Part 1"><meta name=twitter:description content="Multi-part series on working with Kubernetes"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Kubernetes on Raspberry Pi - Part 1","item":"http://localhost:1313/posts/kubernetes-on-raspberry-pi/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Kubernetes on Raspberry Pi - Part 1","name":"Kubernetes on Raspberry Pi - Part 1","description":"Multi-part series on working with Kubernetes","keywords":["kubernetes","homelab","raspberrypi","k3s"],"articleBody":"Introduction Kubernetes is a powerful open-source platform designed to automate deploying, scaling, and operating application containers. When it comes to running Kubernetes on a Raspberry Pi, there are several lightweight distributions available, with K3s being a popular choice. K3s is specifically designed for resource-constrained environments like IoT devices and edge computing, making it an excellent fit for Raspberry Pi. It offers a simplified installation process, reduced resource requirements, and seamless integration with IoT hardware. There are numerous tutorials and guides available on the internet, here is my detailed approach.\nWhat am I trying to achieve? This is a multi-part series as I build out my home lab. Building it from scratch again and documenting the process will help me create reference documentation and share my knowledge to the world. Another advantage of continually rebuilding it from bottom up again is that I will find opportunities to automate manual tasks such that future rebuilds will be much faster.\nAs I had mentioned previously, there are numerous resources online that may already cover this subject but conclude after the cluster is configured. We will go beyond that and much more, so stay tuned!\nHardware and Cost Everyone has their own budget and certainly there will be trade-offs in the hardware you select but for my home lab this is what I used:\nItem Quantity Price Raspberry Pi 4 8GB Model B 4 75.00 Raspberry Pi PoE+ HAT 4 20.00 SanDisk 32GB Ultra Micro Memory Card 4 7.42 Cat6 Snagless Ethernet Patch Cables (10 Pack) 1 12.99 Ubiquiti Unifi Switch Lite 8 PoE 1 109.00 Ubiquiti Unifi Express 1 149.00 Samsung Fit Plus 256GB USB Hard Drive 3 25.00 Yahboom Raspberry Pi Cluster Case 1 21.00 Total Cost 776.67 Hardware Considerations I thought should share my thoughts and considerations when purchasing the above components…\nAt the time of purchase the Raspberry Pi 5 was not released yet - I would have went with that option. I purchased the Raspberry Pi’s at the tail end of the pandemic so there was a limit on the number of Raspberry Pi’s you could purchase due to supply constraints. I wanted to minimize the number of wires and provide for potential future rack mount possibilities so I decided to use PoE to power the Raspberry Pis. I wanted better visibility on my networking so I moved my entire home network to Ubiquiti’s Unifi System. I wanted to potentially run stateful workloads on my Kubernetes cluster, hence the Samsung Fit Plus USB Hard Drive’s which we will use for persistent volumes. I wanted to 3D print my own cluster case but found a cheap temporary solution in the Yahboom Cluster Case. Eventually I want to run a highly available control plane but due to the limitations of my PoE switch, costs and current needs will leave that for a future update.\nNetwork Topology This is an illustration of the network topology for the planned cluster. The nodes and the router talk to each other via the network switch on a wired connection, while the router serves as a gateway to the Internet via Unifi Express hardwired into Google Fibre.\nSince the cluster is running on a private network, I have full control over the IP addresses of each node. This allows me to control which IP addresses the nodes will be assigned. There are two approaches to do this:\nDHCP Reservations Setting desired IP address in the dhcpd.conf file. I have chosen to do DHCP reservations. If you decide to just modify your dhcpd.conf file if there are other competing devices on the network that already use that IP address then there will be a conflict. Certainly you can do a combination of the two, if you want to know more about how to modify your dhcpd file Tom’s Hardware has an excellent guide on how to do this.\nIf you haven’t moved over to a Unifi network setup and you are crazy about metrics like I am… do it! I mean, check this out:\nConfigure Raspberry Pi It’s time to flash the OS image in each of the Micro SD cards that have been installed on each Raspberry Pi. For this, you will need Raspberry Pi Imager. To keep things simple for this setup, I will be using Raspberry Pi OS Lite 64 bit. The Lite version of Raspberry PI OS does not include a desktop environment, unlike Raspberry PI OS which has the Pixel desktop environment integrated into that image. Additionally could also use Ubuntu Desktop/Server environment which I may use in the future if when I want to experiment with MicroK8s or KubeADM but for this series we are going to be using K3s\nFlashing the OS At the time of writing, I am using Raspberry Pi Imager v1.8.5. ymmv on the UI as this can change.\nSince this OS variant does not include a desktop environment, SSH will be my primary method for node installation. While username/password is easier and more convenient to use, I prefer to use SSH Keys as they are generally more secure.\nGenerating an SSH Key The following will work on a Macintosh or Linux, for Windows you will need to use a tool like putty.\nssh-keygen -b 2048 -t rsa -C \"your_username\" -f filename # Example: ssh-keygen -b 2048 -t rsa -C \"jsmith\" -f vivaglint-yyyymmdd OS Customization To help simplify our setup process we are going to customize the settings in the Pi OS image that will be written to our disk.\nSet the hostname of the node (mine will be: controlplane1, worker1, worker2, worker3) You could set a username and password but I did not as I will configure the node to only allow SSH using a key. Set locale settings And finally we want to take the public key from our key-value pair that we previously generated and set that as the desired method to SSH into our nodes.\nRepeat the above steps for the other Raspberry Pi’s. Once I have all the Raspberry Pi’s imaged… I put together the Yahboom cluster case, attached the Raspberry Pi PoE HAT, add the Samsung Fit Plus drives to the worker nodes only.\nYou may want to label your nodes with tape or a label maker, the older you get the easier it is to forget what is what.\nWhat’s Next? In the next step we are going to use Ansible to automate the setup of Kubernetes cluster with K3s and go over in detail the settings I will be using to configure the cluster.\n","wordCount":"1085","inLanguage":"en","image":"http://localhost:1313/images/k8s-raspberry-pi/raspberry-pi-cluster.jpg","datePublished":"2024-06-01T09:13:03Z","dateModified":"2024-06-01T09:13:03Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/kubernetes-on-raspberry-pi/"},"publisher":{"@type":"Organization","name":"Chun Wu","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Chun Wu (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Chun Wu</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/archives/ title=archives><span>archives</span></a></li><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=tags><span>tags</span></a></li><li><a href=http://localhost:1313/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Kubernetes on Raspberry Pi - Part 1</h1><div class=post-description>Multi-part series on working with Kubernetes</div><div class=post-meta><span title='2024-06-01 09:13:03 +0000 +0000'>June 1, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1085 words&nbsp;·&nbsp;Me</div></header><figure class=entry-cover><img loading=eager src=http://localhost:1313/images/k8s-raspberry-pi/raspberry-pi-cluster.jpg alt="Kubernetes on Raspberry Pi"><p>Kubernetes on Raspberry Pi</p></figure><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>Kubernetes is a powerful open-source platform designed to automate deploying, scaling, and operating application containers. When it comes to running Kubernetes on a Raspberry Pi, there are several lightweight distributions available, with K3s being a popular choice. K3s is specifically designed for resource-constrained environments like IoT devices and edge computing, making it an excellent fit for Raspberry Pi. It offers a simplified installation process, reduced resource requirements, and seamless integration with IoT hardware. There are numerous tutorials and guides available on the internet, here is my detailed approach.</p><h2 id=what-am-i-trying-to-achieve>What am I trying to achieve?<a hidden class=anchor aria-hidden=true href=#what-am-i-trying-to-achieve>#</a></h2><p>This is a multi-part series as I build out my home lab. Building it from scratch again and documenting the process will help me create reference documentation and share my knowledge to the world. Another advantage of continually rebuilding it from bottom up again is that I will find opportunities to automate manual tasks such that future rebuilds will be much faster.</p><p>As I had mentioned previously, there are numerous resources online that may already cover this subject but conclude after the cluster is configured. We will go beyond that and much more, so stay tuned!</p><h2 id=hardware-and-cost>Hardware and Cost<a hidden class=anchor aria-hidden=true href=#hardware-and-cost>#</a></h2><p>Everyone has their own budget and certainly there will be trade-offs in the hardware you select but for my home lab this is what I used:</p><table><thead><tr><th style=text-align:left>Item</th><th style=text-align:center>Quantity</th><th style=text-align:right>Price</th></tr></thead><tbody><tr><td style=text-align:left>Raspberry Pi 4 8GB Model B</td><td style=text-align:center>4</td><td style=text-align:right>75.00</td></tr><tr><td style=text-align:left>Raspberry Pi PoE+ HAT</td><td style=text-align:center>4</td><td style=text-align:right>20.00</td></tr><tr><td style=text-align:left>SanDisk 32GB Ultra Micro Memory Card</td><td style=text-align:center>4</td><td style=text-align:right>7.42</td></tr><tr><td style=text-align:left>Cat6 Snagless Ethernet Patch Cables (10 Pack)</td><td style=text-align:center>1</td><td style=text-align:right>12.99</td></tr><tr><td style=text-align:left>Ubiquiti Unifi Switch Lite 8 PoE</td><td style=text-align:center>1</td><td style=text-align:right>109.00</td></tr><tr><td style=text-align:left>Ubiquiti Unifi Express</td><td style=text-align:center>1</td><td style=text-align:right>149.00</td></tr><tr><td style=text-align:left>Samsung Fit Plus 256GB USB Hard Drive</td><td style=text-align:center>3</td><td style=text-align:right>25.00</td></tr><tr><td style=text-align:left>Yahboom Raspberry Pi Cluster Case</td><td style=text-align:center>1</td><td style=text-align:right>21.00</td></tr><tr><td style=text-align:left><strong>Total Cost</strong></td><td style=text-align:center></td><td style=text-align:right><strong>776.67</strong></td></tr></tbody></table><h3 id=hardware-considerations>Hardware Considerations<a hidden class=anchor aria-hidden=true href=#hardware-considerations>#</a></h3><p>I thought should share my thoughts and considerations when purchasing the above components&mldr;</p><ul><li>At the time of purchase the Raspberry Pi 5 was not released yet - I would have went with that option.</li><li>I purchased the Raspberry Pi&rsquo;s at the tail end of the pandemic so there was a limit on the number of Raspberry Pi&rsquo;s you could purchase due to supply constraints.</li><li>I wanted to minimize the number of wires and provide for potential future rack mount possibilities so I decided to use PoE to power the Raspberry Pis.</li><li>I wanted better visibility on my networking so I moved my entire home network to Ubiquiti&rsquo;s Unifi System.</li><li>I wanted to potentially run stateful workloads on my Kubernetes cluster, hence the Samsung Fit Plus USB Hard Drive&rsquo;s which we will use for persistent volumes.</li><li>I wanted to 3D print my own cluster case but found a cheap temporary solution in the Yahboom Cluster Case.</li></ul><p><em>Eventually I want to run a highly available control plane but due to the limitations of my PoE switch, costs and current needs will leave that for a future update.</em></p><h2 id=network-topology>Network Topology<a hidden class=anchor aria-hidden=true href=#network-topology>#</a></h2><p>This is an illustration of the network topology for the planned cluster. The nodes and the router talk to each other via the network switch on a wired connection, while the router serves as a gateway to the Internet via Unifi Express hardwired into Google Fibre.</p><p><img loading=lazy src=/images/k8s-raspberry-pi/network-overview.png alt=Home-Network-Setup></p><p>Since the cluster is running on a private network, I have full control over the IP addresses of each node. This allows me to control which IP addresses the nodes will be assigned. There are two approaches to do this:</p><ol><li>DHCP Reservations</li><li>Setting desired IP address in the dhcpd.conf file.</li></ol><p>I have chosen to do DHCP reservations. If you decide to just modify your dhcpd.conf file if there are other competing devices on the network that already use that IP address then there will be a conflict. Certainly you can do a combination of the two, if you want to know more about how to modify your dhcpd file <a href=https://www.tomshardware.com/how-to/static-ip-raspberry-pi>Tom&rsquo;s Hardware</a> has an excellent guide on how to do this.</p><p>If you haven&rsquo;t moved over to a Unifi network setup and you are crazy about metrics like I am&mldr; do it! I mean, check this out:</p><p><img loading=lazy src=/images/k8s-raspberry-pi/unifi-network-overview.png alt=Unifi-Network-Setup></p><h2 id=configure-raspberry-pi>Configure Raspberry Pi<a hidden class=anchor aria-hidden=true href=#configure-raspberry-pi>#</a></h2><p>It&rsquo;s time to flash the OS image in each of the Micro SD cards that have been installed on each Raspberry Pi. For this, you will need <a href=https://www.raspberrypi.com/software/operating-systems/>Raspberry Pi Imager</a>. To keep things simple for this setup, I will be using Raspberry Pi OS Lite 64 bit. The Lite version of Raspberry PI OS does not include a desktop environment, unlike Raspberry PI OS which has the Pixel desktop environment integrated into that image. Additionally could also use Ubuntu Desktop/Server environment which I may use in the future if when I want to experiment with <a href=https://microk8s.io/>MicroK8s</a> or <a href=https://kubernetes.io/docs/reference/setup-tools/kubeadm/>KubeADM</a> but for this series we are going to be using <a href=https://k3s.io/>K3s</a></p><h3 id=flashing-the-os>Flashing the OS<a hidden class=anchor aria-hidden=true href=#flashing-the-os>#</a></h3><p>At the time of writing, I am using Raspberry Pi Imager v1.8.5. ymmv on the UI as this can change.</p><p><img loading=lazy src=/images/k8s-raspberry-pi/raspberry-pi-imager.png alt=Raspberry-Pi-Imager></p><p>Since this OS variant does not include a desktop environment, SSH will be my primary method for node installation. While username/password is easier and more convenient to use, I prefer to use SSH Keys as they are generally more secure.</p><h3 id=generating-an-ssh-key>Generating an SSH Key<a hidden class=anchor aria-hidden=true href=#generating-an-ssh-key>#</a></h3><p>The following will work on a Macintosh or Linux, for Windows you will need to use a tool like <a href=https://www.putty.org/>putty</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh-keygen -b <span class=m>2048</span> -t rsa -C <span class=s2>&#34;your_username&#34;</span> -f filename
</span></span><span class=line><span class=cl><span class=c1># Example: ssh-keygen -b 2048 -t rsa -C &#34;jsmith&#34; -f vivaglint-yyyymmdd</span>
</span></span></code></pre></div><h3 id=os-customization>OS Customization<a hidden class=anchor aria-hidden=true href=#os-customization>#</a></h3><p>To help simplify our setup process we are going to customize the settings in the Pi OS image that will be written to our disk.</p><ol><li>Set the hostname of the node (mine will be: controlplane1, worker1, worker2, worker3)</li><li>You could set a username and password but I did not as I will configure the node to only allow SSH using a key.</li><li>Set locale settings</li></ol><p><img loading=lazy src=/images/k8s-raspberry-pi/os-customization-01.png alt=OS-Customizations-01></p><p>And finally we want to take the public key from our key-value pair that we previously generated and set that as the desired method to SSH into our nodes.</p><p><img loading=lazy src=/images/k8s-raspberry-pi/os-customization-02.png alt=OS-Customizations-02></p><p>Repeat the above steps for the other Raspberry Pi&rsquo;s. Once I have all the Raspberry Pi&rsquo;s imaged&mldr; I put together the Yahboom cluster case, attached the Raspberry Pi PoE HAT, add the Samsung Fit Plus drives to the <strong>worker</strong> nodes only.</p><p><img loading=lazy src=/images/k8s-raspberry-pi/cluster-case.jpg alt=Cluster-Case></p><p><em>You may want to label your nodes with tape or a label maker, the older you get the easier it is to forget what is what.</em></p><h2 id=whats-next>What&rsquo;s Next?<a hidden class=anchor aria-hidden=true href=#whats-next>#</a></h2><p>In the next step we are going to use <a href=https://www.ansible.com/>Ansible</a> to automate the setup of Kubernetes cluster with K3s and go over in detail the settings I will be using to configure the cluster.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/kubernetes/>Kubernetes</a></li><li><a href=http://localhost:1313/tags/homelab/>Homelab</a></li><li><a href=http://localhost:1313/tags/raspberrypi/>Raspberrypi</a></li><li><a href=http://localhost:1313/tags/k3s/>K3s</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/kubernetes-on-raspberry-pi-2/><span class=title>« Prev</span><br><span>Kubernetes on Raspberry Pi - Part 2</span>
</a><a class=next href=http://localhost:1313/posts/blog-setup/><span class=title>Next »</span><br><span>Custom Domain on Github Pages with Cloudflare</span></a></nav></footer><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://chunwu.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by
Disqus.</a></noscript></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Chun Wu</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>